(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{143:function(e,t,n){e.exports=n(319)},148:function(e,t,n){},150:function(e,t,n){},166:function(e,t,n){},295:function(e,t,n){},305:function(e,t,n){},319:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(33),o=n.n(i),c=(n(148),n(4)),l=n(5),s=n(7),d=n(6),u=n(15),m=n(324),h=(n(150),n(2)),p=n(22),b=n(23),y=n(1),E=n(44),f=n(323),g=(n(166),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={searching:!1,searchText:"",modalOpen:!1},n.toggleSearch=n.toggleSearch.bind(Object(h.a)(Object(h.a)(n))),n.handleSearchText=n.handleSearchText.bind(Object(h.a)(Object(h.a)(n))),n.onClick=n.onClick.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onClick",value:function(){this.setState({modalOpen:!this.state.modalOpen})}},{key:"handleSearchText",value:function(){var e=this;return function(t){e.setState({searchText:t.target.value}),e.props.store.searchText=t.target.value}}},{key:"toggleSearch",value:function(){this.setState({searching:!this.state.searching,searchText:""}),this.props.store.searchText=""}},{key:"render",value:function(){var e=this,t=this.toggleSearch,n=this.onClick;return this.state.searching?r.a.createElement(b.TopAppBar,{dense:!0,fixed:!0},r.a.createElement(b.TopAppBarRow,null,r.a.createElement(b.TopAppBarSection,{className:"search-field",alignStart:!0},r.a.createElement("input",{placeholder:"Search",autoFocus:!0,value:this.state.searchText,onChange:this.handleSearchText()}),r.a.createElement(b.TopAppBarActionItem,{"aria-label":"Search",icon:"clear",alt:"Search this Page",onClick:t})))):r.a.createElement(r.a.Fragment,null,r.a.createElement(b.TopAppBar,{dense:!0,fixed:!0},r.a.createElement(b.TopAppBarRow,null,r.a.createElement(b.TopAppBarSection,{alignStart:!0},r.a.createElement(b.TopAppBarNavigationIcon,{icon:"menu",onClick:n}),r.a.createElement(b.TopAppBarTitle,null,this.props.store.kitchenMode?"BIt's Kitchen":"BIt")),r.a.createElement(b.TopAppBarSection,{alignEnd:!0},r.a.createElement(b.TopAppBarActionItem,{"aria-label":"Search",icon:"search",alt:"Search this Page",onClick:t})))),r.a.createElement(E.Drawer,{modal:!0,open:this.state.modalOpen,onClose:function(){return e.setState({modalOpen:!1})}},r.a.createElement(E.DrawerHeader,null,r.a.createElement(E.DrawerTitle,null,"Menu")),r.a.createElement(E.DrawerContent,null,r.a.createElement(y.List,null,r.a.createElement(f.a,{to:"/orders"},r.a.createElement(y.ListItem,{onClick:n},r.a.createElement(y.ListItemGraphic,{icon:"shopping_cart"}),r.a.createElement(y.ListItemText,null,"Orders"))),r.a.createElement(f.a,{to:"/orderHistory"},r.a.createElement(y.ListItem,{onClick:n},r.a.createElement(y.ListItemGraphic,{icon:"history"}),r.a.createElement(y.ListItemText,null,"History"))),r.a.createElement(f.a,{to:"/dishes"},r.a.createElement(y.ListItem,{onClick:n},r.a.createElement(y.ListItemGraphic,{icon:"shopping_basket"}),r.a.createElement(y.ListItemText,null,"Dishes"))),r.a.createElement(f.a,{to:"/settings"},r.a.createElement(y.ListItem,{onClick:n},r.a.createElement(y.ListItemGraphic,{icon:"settings"}),r.a.createElement(y.ListItemText,null,"Settings")))))))}}]),t}(a.Component)),v=Object(p.b)("store")(Object(p.c)(g)),O=n(9),j=n(10),T=n(8),k=n.n(T),D=n(67),C=n(68),S=n.n(C),_=n(55),I=n(91),x=n(17);function w(){var e=Object(O.a)(["\n  mutation join($id: ID!, $ids: [ID]!){\n    joinOrders(_id: $id, orderIds: $ids){\n      _id,\n      name,\n      table,\n      dishes {\n        dish {\n          _id,\n          name,\n          cost\n        },\n        made,\n        hasPayed\n      }\n    }\n  }"]);return w=function(){return e},e}var L=k()(w()),$=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(d.a)(t).call(this))).state={people:[]},e.handleJoin=e.handleJoin.bind(Object(h.a)(Object(h.a)(e))),e.joinOrders=e.joinOrders.bind(Object(h.a)(Object(h.a)(e))),e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){var n=this;JSON.stringify(e)!==JSON.stringify(t)&&this.setState({people:e.data.map(function(e,t){return{id:e._id,name:e.name,selected:n.state.people.length>t&&n.state.people[t].selected}})})}},{key:"componentDidMount",value:function(){this.setState({people:this.props.data.map(function(e){return{id:e._id,name:e.name,selected:!1}})})}},{key:"handleJoin",value:function(e){var t=this;return function(){var n=t.state.people;n[e].selected=!n[e].selected,t.setState({people:n})}}},{key:"joinOrders",value:function(e){var t=this;return function(){var n=t.state.people.filter(function(e){return e.selected}).map(function(e){return e.id});e({variables:{id:t.props._id,ids:n}})}}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.DialogTitle,null,"Everyone at table ",this.props.table),r.a.createElement(x.DialogContent,null,r.a.createElement(y.List,null,this.state.people.map(function(t,n){return r.a.createElement(y.ListItem,{key:t.id,onClick:e.handleJoin(n)},r.a.createElement(y.ListItemGraphic,{icon:t.selected?"radio_button_checked":"radio_button_unchecked"}),r.a.createElement(y.ListItemText,null,t.name))}))),r.a.createElement(x.DialogActions,null,r.a.createElement(x.DialogButton,{action:"close"},"Cancel"),r.a.createElement(j.Mutation,{mutation:L},function(t){return r.a.createElement(x.DialogButton,{action:"accept",onClick:e.joinOrders(t),isDefaultAction:!0},"Join")})))}}]),t}(a.Component);function F(){var e=Object(O.a)(["\n                query order($table: Int) {\n                  orders(table: $table, hasPayed: false) {\n                    _id,\n                    name,\n                  }\n                }"]);return F=function(){return e},e}var P=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(s.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={standardDialogOpen:!1},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.Query,{query:k()(F()),variables:{table:this.props.table},pollInterval:5e3},function(t){var n=t.loading,a=t.error,i=t.data;return!n&&!a&&i&&i.orders?r.a.createElement(x.Dialog,{open:e.state.standardDialogOpen,onClose:function(t){return e.setState({standardDialogOpen:!1})}},r.a.createElement($,Object.assign({data:i.orders.filter(function(t){return t._id!==e.props._id})},e.props))):r.a.createElement(x.SimpleDialog,{title:"Everyone at table ".concat(e.props.table),body:"Fetching Data",open:e.state.standardDialogOpen,onClose:function(t){return e.setState({standardDialogOpen:!1})}})}),r.a.createElement(_.CardAction,{onClick:function(t){return e.setState({standardDialogOpen:!0})}},"Join"))}}]),t}(a.Component);n(295);function M(){var e=Object(O.a)(["\n  mutation updateOrder($id: ID!, $dishes: [orderDishMutation]!){\n    updateOrder(_id: $id, dishes: $dishes){\n      _id,\n      name,\n      table,\n      notes,\n      dishes {\n        dish {\n          _id,\n          name,\n          cost\n        },\n        made,\n        hasPayed\n      }\n    }\n  }"]);return M=function(){return e},e}var A=k()(M()),B=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(d.a)(t).call(this))).handleDishMade=e.handleDishMade.bind(Object(h.a)(Object(h.a)(e))),e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleDishMade",value:function(e,t,n){var a=this;return function(){var r=a.props.dishes.map(function(e){return{id:e.dish._id,made:e.made,hasPayed:e.hasPayed}});r[t].made=!r[t].made,n({variables:{id:e,dishes:r}})}}},{key:"render",value:function(){var e=this,t=this.props;return r.a.createElement(_.Card,null,r.a.createElement(f.a,{to:"/orderDetails/".concat(t._id)},r.a.createElement(_.CardPrimaryAction,null,r.a.createElement("div",{style:{padding:"0 1rem 1rem 1rem"}},r.a.createElement(I.Typography,{use:"headline6",tag:"h2",style:{}},r.a.createElement("span",{className:"highlight"},t.table)," ",t.name)))),r.a.createElement("div",{style:{padding:"0 1rem 1rem 1rem"}},r.a.createElement(j.Mutation,{mutation:A},function(n){return r.a.createElement(I.Typography,{use:"body1",tag:"div",theme:"text-secondary-on-background"},r.a.createElement(y.List,null,t.dishes.map(function(a,i){return r.a.createElement(y.ListItem,{key:i,onClick:e.handleDishMade(t._id,i,n)},r.a.createElement(y.ListItemGraphic,{icon:a.made?"radio_button_checked":"radio_button_unchecked"}),r.a.createElement(y.ListItemText,null,a.dish.name))})))})),r.a.createElement(I.Typography,{use:"subtitle1",tag:"div",style:{padding:"0.5rem 1rem"},theme:"text-secondary-on-background"},this.props.notes),r.a.createElement(_.CardActions,null,r.a.createElement(_.CardActionButtons,null,r.a.createElement(P,this.props)),r.a.createElement(_.CardActionIcons,null,r.a.createElement(f.a,{to:"/payOrder/".concat(t._id)},r.a.createElement(_.CardAction,{icon:"credit_card"})))))}}]),t}(a.Component),N=n(21);function G(){var e=Object(O.a)(["query order($hasPayed: Boolean) {\n              orders(hasPayed: $hasPayed) {\n                _id,\n                name,\n                table,\n                notes,\n                dishes {\n                  dish {\n                    _id,\n                    name,\n                    cost,\n                    type {\n                      _id,\n                      name\n                    }\n                  },\n                  made,\n                  hasPayed\n                }\n              }\n            }"]);return G=function(){return e},e}var R=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.store.searchText,n=new RegExp(t,"i");return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.Query,{query:k()(G()),variables:{hasPayed:!1},pollInterval:500},function(a){var i=a.loading,o=a.error,c=a.data;c&&c.orders||(c={orders:[]});var l=r.a.createElement(S.a,{id:"masonry-layout"},c.orders.filter(function(a){return(!t||a.table.toString()===t||n.test(a.name)||a.dishes.some(function(e){return n.test(e.dish.type.name)}))&&(!e.props.store.kitchenMode||a.dishes.some(function(e){return!e.made}))}).map(function(t,n){return r.a.createElement("div",{key:n,style:{width:"-webkit-fill-available",maxWidth:"500px",minWidth:"320px"}},r.a.createElement(B,Object.assign({key:t._id},t,e.props)))}));return i&&(l=r.a.createElement(r.a.Fragment,null,r.a.createElement(N.LinearProgress,{determinate:!1}),l)),o?(console.warn(o),r.a.createElement("p",null,"Error :(")):l}),r.a.createElement(f.a,{to:"/orderDetails"},r.a.createElement(D.Fab,{className:"floating-right",icon:"add"})),r.a.createElement("div",{className:"bottomSpacer"}))}}]),t}(a.Component),q=Object(p.b)("store")(Object(p.c)(R)),W=n(25),H=n(14),J=n(30),Q=n(121),z=n(122),K=n(31),U=n(56);n(305);function Y(){var e=Object(O.a)(["\n  mutation updateOrder($id: ID!, $name: String, $table: Int, $notes: String, $dishes: [orderDishMutation]){\n    updateOrder(_id: $id, table: $table, name: $name, dishes: $dishes, notes: $notes ){\n      _id, \n      name,\n      table,\n      notes\n    }\n  }\n"]);return Y=function(){return e},e}function V(){var e=Object(O.a)(["\n  mutation addOrder($name: String, $table: Int!, $notes: String, $dishes: [orderDishMutation]!){\n    addOrder(table: $table, name: $name, dishes: $dishes, notes: $notes){\n      _id, \n      name,\n      table,\n      notes\n    }\n  }\n"]);return V=function(){return e},e}var X=k()(V()),Z=k()(Y()),ee=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(d.a)(t).call(this))).state={id:"",name:"",table:0,notes:"",dishes:[],activeTabIndex:0,dishTypes:{}},e.addDish=e.addDish.bind(Object(h.a)(Object(h.a)(e))),e.removeDish=e.removeDish.bind(Object(h.a)(Object(h.a)(e))),e.changeTextField=e.changeTextField.bind(Object(h.a)(Object(h.a)(e))),e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.order&&this.setState({id:this.props.order._id,name:this.props.order.name,table:this.props.order.table,notes:this.props.order.notes,dishes:this.props.order.dishes.map(function(e){return{dish:{id:e.dish._id,name:e.dish.name},made:e.made,hasPayed:e.hasPayed}})});var e=this.state.dishTypes;this.props.dishes.forEach(function(t){e[t.type.name]?e[t.type.name].push(t):e[t.type.name]=[t]}),this.setState({dishTypes:e})}},{key:"addDish",value:function(e,t){var n=this;return function(){var a=[{dish:{id:e,name:t},made:!1,hasPayed:!1}].concat(n.state.dishes);n.setState({dishes:a})}}},{key:"removeDish",value:function(e){var t=this;return function(){var n=t.state.dishes;1===n.length?n=[]:n.splice(e,1),t.setState({dishes:n})}}},{key:"changeTextField",value:function(e){var t=this;return function(n){var a={};a[e]=n.target.value,t.setState(a)}}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.dishTypes);return r.a.createElement(r.a.Fragment,null,r.a.createElement(J.Grid,{className:"order-details"},r.a.createElement(J.GridCell,{span:"12"},0===t.length?String():r.a.createElement(Q.TabBar,{activeTabIndex:this.state.activeTabIndex,onActivate:function(t){e.setState({activeTabIndex:t.detail.index})}},t.map(function(e,t){return r.a.createElement(Q.Tab,{key:t},e)})),r.a.createElement(z.ChipSet,null,(this.state.dishTypes[t[this.state.activeTabIndex]]||[]).map(function(t,n){return r.a.createElement(z.Chip,{key:n,onClick:e.addDish(t._id,t.name),text:t.name})})))),r.a.createElement(J.Grid,{className:"order-details"},r.a.createElement(J.GridCell,{span:"6"},r.a.createElement(y.List,null,this.state.dishes.map(function(t,n){return t.hasPayed||t.made?r.a.createElement(y.ListItem,{key:n,ripple:!1},r.a.createElement(y.ListItemGraphic,{icon:t.hasPayed?"attach_money":"done"}),r.a.createElement(y.ListItemText,null,t.dish.name)):r.a.createElement(y.ListItem,{key:n,onClick:e.removeDish(n)},r.a.createElement(y.ListItemGraphic,{icon:"remove"}),r.a.createElement(y.ListItemText,null,t.dish.name))}))),r.a.createElement(J.GridCell,{span:"6"},r.a.createElement(K.TextField,{withLeadingIcon:"event_seat",label:"Table",type:"number",min:"0",inputMode:"numeric",pattern:"\\d*",value:this.state.table,onChange:this.changeTextField("table")}),r.a.createElement(K.TextField,{withLeadingIcon:"account_circle",label:"Name",value:this.state.name,onChange:this.changeTextField("name")}),r.a.createElement(K.TextField,{textarea:!0,fullwidth:!0,label:"Notes",type:"number",value:this.state.notes,onChange:this.changeTextField("notes")}))),r.a.createElement(j.Mutation,{mutation:this.props.id?Z:X},function(t,n){var a=n.data,i=n.loading,o=n.error,c=r.a.createElement(U.Button,{onClick:function(){return t({variables:{id:e.state.id,table:parseInt(e.state.table),name:e.state.name,notes:e.state.notes,dishes:e.state.dishes.map(function(e){return{id:e.dish.id,made:e.made,hasPayed:e.hasPayed}}).filter(function(e){return e&&e.id})}})},theme:"secondary"},"Save");return i&&(c=r.a.createElement(r.a.Fragment,null,r.a.createElement(N.LinearProgress,{determinate:!1}),c)),o&&console.error(o),a&&e.props.history.goBack(),c}))}}]),t}(a.Component);function te(){var e=Object(O.a)(["\n            {\n              dishes {\n                _id,\n                name,\n                type {\n                  _id,\n                  name\n                }\n              }\n            }"]);return te=function(){return e},e}function ne(){var e=Object(O.a)(["\n        query order($id: ID) {\n          orders(_id: $id) {\n            _id,\n            name,\n            table,\n            notes,\n            dishes {\n              dish {\n                _id,\n                name\n              }, \n              made,\n              hasPayed,\n            }\n          }\n        }"]);return ne=function(){return e},e}var ae=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"fetchData",value:function(e,t){var n=this;return r.a.createElement(j.Query,{query:k()(ne()),variables:{id:e}},function(e){var a=e.loading,i=e.error,o=e.data;return a?r.a.createElement(N.LinearProgress,{determinate:!1}):i?r.a.createElement("p",null,"Error :("):r.a.createElement(ee,{order:o.orders[0],dishes:t,id:!0,history:n.props.history})})}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;return r.a.createElement(W.Elevation,{className:"main-elevation",z:24},r.a.createElement(H.Toolbar,null,r.a.createElement(H.ToolbarRow,null,r.a.createElement(H.ToolbarSection,{alignStart:!0},r.a.createElement(H.ToolbarTitle,null,"Order Details")),r.a.createElement(H.ToolbarSection,{alignEnd:!0},r.a.createElement(H.ToolbarIcon,{icon:"clear",onClick:function(){return e.props.history.goBack()}})))),r.a.createElement(j.Query,{query:k()(te())},function(n){var a=n.loading,i=n.error,o=n.data;return a?r.a.createElement(N.LinearProgress,{determinate:!1}):i?r.a.createElement("p",null,"Error :( ",r.a.createElement("br",null),r.a.createElement("br",null),i.graphQLErrors.map(function(e,t){var n=e.message;return r.a.createElement("span",{key:t},n)})):t?e.fetchData(t,o.dishes):r.a.createElement(ee,{dishes:o.dishes,history:e.props.history})}))}}]),t}(a.Component);var re=function(e){var t="",n=e.reduce(function(e,t){return e+t.cost},0).toFixed(2);return e.forEach(function(e){t+="  \n        <tr>\n          <td>".concat(e.name,"</td>\n          <td>").concat(e.cost.toFixed(2),"</td>\n        </tr>")}),'\n<!DOCTYPE html>\n<html lang="en">\n  <body>\n    <h1>Receipt</h1>\n    <h3>'.concat((new Date).toLocaleString(),"</h3>\n    <p>\n      <table>\n        <tr>\n          <th></th>\n          <th>Amount</th>\n        </tr>\n        ").concat(t,"\n        <tr>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td>Total</td>\n          <td>").concat(n,"</td>\n        </tr>\n        <tr>\n          <td>Tax</td>\n          <td>").concat((n-n/1.19).toFixed(2),"</td>\n        </tr>\n      </table>\n    </p>\n  </body>\n</html>")},ie=n(118),oe=n.n(ie);function ce(){var e=Object(O.a)(["\n  mutation pay($id: ID!, $dishes: [orderDishMutation]!){\n    updateOrder(_id: $id, dishes: $dishes){\n      _id\n    }\n  }"]);return ce=function(){return e},e}var le=k()(ce()),se=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(d.a)(t).call(this))).state={dishes:[],paying:0,selectAll:!0},e.changePayment=e.changePayment.bind(Object(h.a)(Object(h.a)(e))),e.toggleSelection=e.toggleSelection.bind(Object(h.a)(Object(h.a)(e))),e.toggleAll=e.toggleAll.bind(Object(h.a)(Object(h.a)(e))),e.saveFile=e.saveFile.bind(Object(h.a)(Object(h.a)(e))),e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"toggleSelection",value:function(e){var t=this;return function(){var n=t.state.dishes;n[e].paying=!n[e].paying,t.setState({dishes:n,selectAll:n.every(function(e){return e.paying})})}}},{key:"toggleAll",value:function(){var e=!this.state.selectAll,t=this.state.dishes,n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){i.value.paying=e}}catch(c){a=!0,r=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}this.setState({dishes:t,selectAll:e})}},{key:"changePayment",value:function(){var e=this;return function(t){isNaN(t.target.value)||e.setState({paying:t.target.value})}}},{key:"componentDidMount",value:function(){this.setState({dishes:this.props.dishesToPay})}},{key:"saveFile",value:function(e){var t=new Blob([re(e)],{type:"text/plain;charset=utf-8"});oe.a.saveAs(t,"Receipt ".concat((new Date).toUTCString(),".html"),!0)}},{key:"render",value:function(){var e=this,t=0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.List,null,r.a.createElement(y.ListItem,{key:-1,onClick:this.toggleAll},r.a.createElement(y.ListItemGraphic,{icon:this.state.selectAll?"radio_button_checked":"radio_button_unchecked"}),r.a.createElement(y.ListItemText,null,"Everything")),r.a.createElement(y.ListDivider,null),this.state.dishes.map(function(n,a){return n.paying&&(t=n.dish.cost+t),r.a.createElement(y.ListItem,{key:a,onClick:e.toggleSelection(a)},r.a.createElement(y.ListItemGraphic,{icon:n.paying?"radio_button_checked":"radio_button_unchecked"}),r.a.createElement(y.ListItemText,null,n.dish.name),r.a.createElement(y.ListItemMeta,{tag:"span",basename:""},n.dish.cost.toFixed(2)))})),r.a.createElement(J.Grid,null,r.a.createElement(J.GridCell,{span:"12"},r.a.createElement(K.TextField,{withLeadingIcon:"euro_symbol",disabled:!0,label:"Total",value:t.toFixed(2)}),r.a.createElement(K.TextField,{withLeadingIcon:"euro_symbol",label:"Difference",value:(this.state.paying-t).toFixed(2),onChange:function(){},invalid:this.state.paying-t<0}),r.a.createElement(K.TextField,{withLeadingIcon:"euro_symbol",label:"Paying",type:"number",inputMode:"numeric",pattern:"\\d*.*,*\\d*",value:this.state.paying,onChange:this.changePayment()}))),r.a.createElement(j.Mutation,{mutation:le},function(t,n){var a=n.data,i=n.loading,o=n.error,c=r.a.createElement(U.Button,{onClick:function(){t({variables:{id:e.props.id,dishes:e.state.dishes.map(function(e){return{id:e.dish._id,made:e.made,hasPayed:e.paying}}).concat(e.props.payedDishes.map(function(e){return{id:e.dish._id,made:e.made,hasPayed:e.hasPayed}}))}})}},"Pay");return i&&(c=r.a.createElement(r.a.Fragment,null,r.a.createElement(N.LinearProgress,{determinate:!1}),c)),o&&console.error(o),a&&e.props.history.goBack(),c}),r.a.createElement(U.Button,{theme:"secondary",onClick:function(){return e.saveFile(e.state.dishes.filter(function(e){return e.paying}).map(function(e){return e.dish}))}},r.a.createElement(U.ButtonIcon,{icon:"cloud_download"}),"Download"))}}]),t}(a.Component);function de(){var e=Object(O.a)(["\n                query order($id: ID) {\n                  orders(_id: $id) {\n                    _id,\n                    name,\n                    table,\n                    dishes {\n                      dish {\n                        _id,\n                        name,\n                        cost\n                      },\n                      hasPayed,\n                      made\n                    }\n                  }\n                }"]);return de=function(){return e},e}var ue=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.match.params.id;return r.a.createElement(W.Elevation,{className:"main-elevation",z:24},r.a.createElement(H.Toolbar,null,r.a.createElement(H.ToolbarRow,null,r.a.createElement(H.ToolbarSection,{alignStart:!0},r.a.createElement(H.ToolbarTitle,null,"Pay Order")),r.a.createElement(H.ToolbarSection,{alignEnd:!0},r.a.createElement(H.ToolbarIcon,{icon:"clear",onClick:function(){return e.props.history.goBack()}})))),r.a.createElement(j.Query,{query:k()(de()),variables:{id:t}},function(n){var a=n.loading,i=n.error,o=n.data;return a?r.a.createElement("p",null,"Loading..."):i?r.a.createElement("p",null,"Error :("):1!==o.orders.length?String():r.a.createElement(se,{history:e.props.history,id:t,payedDishes:o.orders[0].dishes.filter(function(e){return e.hasPayed}),dishesToPay:o.orders[0].dishes.filter(function(e){return!e.hasPayed}).map(function(e){return{dish:e.dish,made:e.made,paying:!0}})})}))}}]),t}(a.Component),me=n(135);function he(){var e=Object(O.a)(["mutation remove($id: ID!){\n removeDish(_id: $id, ){\n   _id, \n   name\n }\n}"]);return he=function(){return e},e}function pe(){var e=Object(O.a)(["mutation update($id: ID!, $name: String, $cost: Float, $type: ID){\n updateDish(_id: $id, name: $name, cost: $cost, type: $type){\n   _id, \n   name\n }\n}"]);return pe=function(){return e},e}function be(){var e=Object(O.a)([" mutation add($name: String!, $cost: Float!, $type: ID!){\n addDish(name: $name, cost: $cost, type: $type){\n   _id, \n   name\n }\n}"]);return be=function(){return e},e}var ye=k()(be()),Ee=k()(pe()),fe=k()(he()),ge=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={name:"",cost:0,type:"",standardDialogOpen:!1},n.handleNameChange=n.handleNameChange.bind(Object(h.a)(Object(h.a)(n))),n.handleCostChange=n.handleCostChange.bind(Object(h.a)(Object(h.a)(n))),n.handleTypeChange=n.handleTypeChange.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){!e._id||e.name===t.name&&e.cost===t.cost&&e.type._id===t.type._id||this.setState({name:e.name,cost:e.cost.toFixed(2),type:e.type._id})}},{key:"componentDidMount",value:function(){this.props._id&&this.setState({name:this.props.name,cost:this.props.cost.toFixed(2),type:this.props.type._id})}},{key:"handleNameChange",value:function(e){this.setState({name:e.target.value||""})}},{key:"handleCostChange",value:function(e){this.setState({cost:e.target.value})}},{key:"handleTypeChange",value:function(e){this.setState({type:e.target.value})}},{key:"toggleDialog",value:function(){var e=this;return function(){e.setState({name:e.props.name||"",cost:e.props.cost||0,type:e.props.type?e.props.type._id:"",standardDialogOpen:!e.state.standardDialogOpen})}}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.Dialog,{open:this.state.standardDialogOpen,onClose:function(t){return e.setState({standardDialogOpen:!1})}},r.a.createElement(x.DialogTitle,null,this.props._id?"Edit ".concat(this.props.name):"New dish"),r.a.createElement(x.DialogContent,null,r.a.createElement(K.TextField,{type:"text",label:"Name",value:this.state.name,onChange:this.handleNameChange}),r.a.createElement(K.TextField,{type:"number",inputMode:"numeric",label:"Cost",invalid:!1,value:this.state.cost,onChange:this.handleCostChange}),r.a.createElement(me.Select,{value:this.state.type,onChange:this.handleTypeChange,placeholder:"",label:"Dish type",options:this.props.dishTypes})),r.a.createElement(x.DialogActions,null,r.a.createElement(x.DialogButton,{theme:"secondary",action:"cloase",isDefaultAction:!0},"Cancel"),this.props._id?r.a.createElement(j.Mutation,{mutation:fe},function(t){return r.a.createElement(x.DialogButton,{action:"accept",onClick:function(){return t({variables:{id:e.props._id}})}},"Delete")}):String(),r.a.createElement(j.Mutation,{mutation:this.props._id?Ee:ye},function(t){return r.a.createElement(x.DialogButton,{action:"accept",onClick:function(){t({variables:{id:e.props._id,name:e.state.name,type:e.state.type,cost:parseFloat(e.state.cost)}})}},"Save")}))),this.props._id?r.a.createElement(y.SimpleListItem,{key:this.props._id,onClick:this.toggleDialog(),text:this.props.name,secondaryText:"\u20ac ".concat(this.props.cost.toFixed(2)),meta:"edit"}):r.a.createElement(D.Fab,{className:"floating-right",icon:"add",onClick:this.toggleDialog()}))}}]),t}(a.Component),ve=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(W.Elevation,{className:"main-elevation",z:24,style:{margin:"1rem"}},r.a.createElement(H.Toolbar,null,r.a.createElement(H.ToolbarRow,null,r.a.createElement(H.ToolbarSection,{alignStart:!0},r.a.createElement(H.ToolbarTitle,null,this.props.typeName)))),r.a.createElement(y.List,{twoLine:!0},this.props.dishes.map(function(t){return r.a.createElement(ge,Object.assign({key:t._id},t,{dishTypes:e.props.dishTypes}))})))}}]),t}(a.Component);function Oe(){var e=Object(O.a)(["query dishes {\n              dishes {\n                _id,\n                name,\n                cost,\n                type {\n                  _id,\n                  name\n                }\n              }\n            }"]);return Oe=function(){return e},e}function je(){var e=Object(O.a)(["query dishTypes {\n              dishTypes {\n                _id,\n                name\n                }\n              }"]);return je=function(){return e},e}var Te=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"groupBy",value:function(e,t){return e.reduce(function(e,n){return(e[t(n)]=e[t(n)]||[]).push(n),e},{})}},{key:"render",value:function(){var e=this,t=this.props.store.searchText,n=new RegExp(t,"i");return r.a.createElement(j.Query,{query:k()(je()),pollInterval:1e3},function(a){var i=a.data,o=[];return i&&i.dishTypes&&(o=i.dishTypes.map(function(e){return{label:e.name,value:e._id}})),r.a.createElement(r.a.Fragment,null,r.a.createElement(j.Query,{query:k()(Oe()),pollInterval:1e3},function(a){var i=a.loading,c=a.error,l=a.data;l&&l.dishes||(l={dishes:[]});var s=e.groupBy(l.dishes.filter(function(e){return!t||n.test(e.name)||n.test(e.type.name)}),function(e){return e.type.name}),d=[];for(var u in s)d.push(r.a.createElement("div",{key:s[u][0]._id,style:{width:"-webkit-fill-available",maxWidth:"500px",minWidth:"320px"}},r.a.createElement(ve,{typeName:u,dishes:s[u],dishTypes:o})));var m=r.a.createElement(S.a,{id:"masonry-layout"},d);return i&&(m=r.a.createElement(r.a.Fragment,null,r.a.createElement(N.LinearProgress,{determinate:!1}),m)),c?r.a.createElement("p",null,"Error :("):m}),r.a.createElement(ge,{dishTypes:o}),r.a.createElement("div",{className:"bottomSpacer"}))})}}]),t}(a.Component),ke=Object(p.b)("store")(Object(p.c)(Te)),De=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.Toolbar,null,r.a.createElement(H.ToolbarRow,null,r.a.createElement(H.ToolbarSection,{alignStart:!0},r.a.createElement(H.ToolbarTitle,null,"Global Settings")))),r.a.createElement(y.List,null,r.a.createElement(y.ListItem,{onClick:function(){return e.props.store.setKitchenMode(!e.props.store.kitchenMode)}},r.a.createElement(y.ListItemGraphic,{icon:this.props.store.kitchenMode?"radio_button_checked":"radio_button_unchecked"}),r.a.createElement(y.ListItemText,null,"Kitchen Mode"))))}}]),t}(a.Component),Ce=Object(p.b)("store")(Object(p.c)(De)),Se=n(136),_e=n(137),Ie=n(120);function xe(){var e=Object(O.a)(["mutation remove($id: ID!){\n removeDishType(_id: $id, ){\n   _id, \n   name\n }\n}"]);return xe=function(){return e},e}function we(){var e=Object(O.a)(["mutation update($id: ID!, $name: String!){\n updateDishType(_id: $id, name: $name){\n   _id, \n   name\n }\n}"]);return we=function(){return e},e}function Le(){var e=Object(O.a)([" mutation add($name: String!){\n addDishType(name: $name){\n   _id, \n   name\n }\n}"]);return Le=function(){return e},e}var $e=k()(Le()),Fe=k()(we()),Pe=k()(xe()),Me=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={name:""},n.handleNameChange=n.handleNameChange.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e,t){e.name&&e.name!==t.name&&this.setState({name:e.name})}},{key:"componentDidMount",value:function(){this.props.name&&this.setState({name:this.props.name})}},{key:"toggleDialog",value:function(){var e=this;return function(){e.setState({name:e.props.name,standardDialogOpen:!e.state.standardDialogOpen})}}},{key:"handleNameChange",value:function(e){this.setState({name:e.target.value||""})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.Dialog,{open:this.state.standardDialogOpen,onClose:function(t){return e.setState({standardDialogOpen:!1})}},r.a.createElement(x.DialogTitle,null,this.props._id?"Edit dish type":"New dish type"),r.a.createElement(x.DialogContent,null,r.a.createElement(_e.TextField,{type:"text",label:"Name",value:this.state.name||"",onChange:this.handleNameChange})),r.a.createElement(x.DialogActions,null,r.a.createElement(x.DialogButton,{theme:"secondary",action:"cancel",isDefaultAction:!0},"Cancel"),this.props._id?r.a.createElement(j.Mutation,{mutation:Pe},function(t){return r.a.createElement(x.DialogButton,{action:"accept",onClick:function(){return t({variables:{id:e.props._id}})}},"Delete")}):String(),r.a.createElement(j.Mutation,{mutation:this.props._id?Fe:$e},function(t){return r.a.createElement(x.DialogButton,{action:"accept",onClick:function(){return t({variables:{id:e.props._id,name:e.state.name}})}},"Save")}))),this.props._id?r.a.createElement(Ie.ListItem,{onClick:this.toggleDialog()},r.a.createElement(Ie.ListItemText,null,this.props.name),r.a.createElement(Ie.ListItemMeta,{icon:"edit"})):r.a.createElement(Se.ToolbarIcon,{icon:"add",onClick:this.toggleDialog()}))}}]),t}(a.Component);function Ae(){var e=Object(O.a)(["query dishTypes {\n              dishTypes {\n                _id,\n                name\n                }\n              }"]);return Ae=function(){return e},e}var Be=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.Toolbar,null,r.a.createElement(H.ToolbarRow,null,r.a.createElement(H.ToolbarSection,{alignStart:!0},r.a.createElement(H.ToolbarTitle,null,"Dish types")),r.a.createElement(H.ToolbarSection,{alignEnd:!0},r.a.createElement(Me,null)))),r.a.createElement(j.Query,{query:k()(Ae()),variables:{hasPayed:!1},pollInterval:1e3},function(e){var t=e.loading,n=e.error,a=e.data;a&&a.dishTypes||(a={dishTypes:[]});var i=r.a.createElement(y.List,null,a.dishTypes.map(function(e){return r.a.createElement(Me,Object.assign({key:e._id},e))}));return t&&(i=r.a.createElement(r.a.Fragment,null,r.a.createElement(N.LinearProgress,{determinate:!1}),i)),n?r.a.createElement("p",null,"Error :("):i}))}}]),t}(a.Component),Ne=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(J.Grid,null,r.a.createElement(J.GridCell,{span:"12"},r.a.createElement(W.Elevation,{className:"main-elevation",z:24},r.a.createElement(Ce,null))),r.a.createElement(J.GridCell,{span:"12"},r.a.createElement(W.Elevation,{className:"main-elevation",z:24},r.a.createElement(Be,null))))}}]),t}(a.Component),Ge=n(35);function Re(){var e=Object(O.a)(["\n            {\n              orders(hasPayed: true) {\n                timestamp\n                dishes {\n                  dish {\n                    name,\n                    cost,\n                    type{\n                      name\n                    } \n                  }\n                }\n              }\n            }"]);return Re=function(){return e},e}var qe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={menuIsOpen:!1,minOrderTimestamp:new Date("0"),header:"History"},n.setHistoryFilter=n.setHistoryFilter.bind(Object(h.a)(Object(h.a)(n))),n.getMonday=n.getMonday.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getMonday",value:function(e){var t=(e=new Date(e)).getDay(),n=e.getDate()-t+(0===t?-6:1);return new Date(e.setDate(n))}},{key:"downloadData",value:function(e){var t=new Blob(e.map(function(e){return"".concat(e.timestamp.toISOString(),",").concat(e.name,",").concat(e.type,",").concat(e.cost,"\n")}),{type:"text/plain;charset=utf-8"});oe.a.saveAs(t,"Orders.csv",!0)}},{key:"setHistoryFilter",value:function(e){var t=new Date("0"),n="History";1===e.detail.index?(t=this.getMonday(new Date((new Date).toDateString())),n="This weeks History"):2===e.detail.index&&(t=new Date((new Date).toDateString()),n="Todays History"),this.setState({minOrderTimestamp:t,header:n})}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;return r.a.createElement(W.Elevation,{className:"main-elevation",z:24},r.a.createElement(j.Query,{query:k()(Re())},function(n){var a=n.loading,i=n.error,o=n.data;if(a)return r.a.createElement(N.LinearProgress,{determinate:!1});if(i)return r.a.createElement("p",null,"Error :(");if(t)return e.fetchData(t,o.dishes);var c=[];return o&&o.orders&&o.orders.forEach(function(t){t.dishes.forEach(function(n){var a=new Date(t.timestamp);a>=e.state.minOrderTimestamp&&c.push({timestamp:a,name:n.dish.name,cost:n.dish.cost.toFixed(2),type:n.dish.type.name})})}),r.a.createElement(r.a.Fragment,null,r.a.createElement(H.Toolbar,null,r.a.createElement(H.ToolbarRow,null,r.a.createElement(H.ToolbarSection,{alignStart:!0},r.a.createElement(H.ToolbarTitle,null,e.state.header)),r.a.createElement(H.ToolbarSection,{alignEnd:!0},r.a.createElement(Ge.MenuSurfaceAnchor,null,r.a.createElement(Ge.Menu,{open:e.state.menuIsOpen,onSelect:e.setHistoryFilter,onClose:function(t){return e.setState({menuIsOpen:!1})}},r.a.createElement(Ge.MenuItem,null,"Everything"),r.a.createElement(Ge.MenuItem,null,"This Week"),r.a.createElement(Ge.MenuItem,null,"Today")),r.a.createElement(H.ToolbarIcon,{icon:"filter_list",onClick:function(t){return e.setState({menuIsOpen:!e.state.menuIsOpen})}})),r.a.createElement(H.ToolbarIcon,{icon:"cloud_download",onClick:function(){return e.downloadData(c)}})))),r.a.createElement(y.List,null,c.map(function(e,t){return r.a.createElement(y.ListItem,{key:t},r.a.createElement(y.ListItemText,null,e.name,r.a.createElement(y.ListItemSecondaryText,null," ",e.timestamp.toDateString()," ")),r.a.createElement(y.ListItemMeta,{tag:"span",basename:""},"\u20ac ".concat(e.cost)))})))}))}}]),t}(a.Component),We=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(v,null),r.a.createElement("div",{className:"mdc-top-app-bar--fixed-adjust"},r.a.createElement(m.a,{exact:!0,path:"/",component:q}),r.a.createElement(m.a,{path:"/orders",component:q}),r.a.createElement(m.a,{path:"/orderDetails/:id?",component:ae}),r.a.createElement(m.a,{path:"/payOrder/:id",component:ue}),r.a.createElement(m.a,{path:"/dishes",component:ke}),r.a.createElement(m.a,{path:"/settings",component:Ne}),r.a.createElement(m.a,{path:"/orderHistory",component:qe})))}}]),t}(a.Component),He=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Je(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Qe=n(325),ze=n(141),Ke=n(18),Ue=function(){function e(){Object(c.a)(this,e),this.searchText="",this.kitchenMode="true"===localStorage.getItem("Bit.KitchenMode")||!1}return Object(l.a)(e,[{key:"setKitchenMode",value:function(e){this.kitchenMode=e,localStorage.setItem("Bit.KitchenMode",e)}}]),e}();Object(Ke.f)(Ue,{searchText:Ke.k,kitchenMode:Ke.k});var Ye=new Ue,Ve=n(139),Xe=new ze.a,Ze={store:Ye};o.a.render(r.a.createElement(Ve.ThemeProvider,{options:{primary:"#795548",secondary:"#486c79",background:"#fff"}},r.a.createElement(j.ApolloProvider,{client:Xe},r.a.createElement(p.a,Ze,r.a.createElement(Qe.a,null,r.a.createElement(We,null))))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");He?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Je(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Je(t,e)})}}()}},[[143,2,1]]]);
//# sourceMappingURL=main.d9172917.chunk.js.map